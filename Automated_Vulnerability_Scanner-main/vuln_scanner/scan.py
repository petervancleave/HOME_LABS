from vulnerability_scanner.netscan import scan_network
from vulnerability_scanner.webscan import scan_web
from vulnerability_scanner.cve_lookup import get_cve_info
from vulnerability_scanner.report_generation import generate_report

def start_scan():
    # Network scan
    target = input("Enter the target IP or subnet (e.x., 127.0.0.1): ")
    network_results = scan_network(target)

    # Web scan
    web_target = input("Enter the target web URL: ")
    web_results = scan_web(web_target)

    # CVE lookup (you can exclude this if you don't want to call it in scan)
    # For example, Apache:
    service_name = "Apache"
    cve_info = get_cve_info(service_name)
    print(f"CVE Info for {service_name}: {cve_info}")

    # Generate report
    generate_report(network_results, web_results)

if __name__ == "__main__":
    start_scan()
