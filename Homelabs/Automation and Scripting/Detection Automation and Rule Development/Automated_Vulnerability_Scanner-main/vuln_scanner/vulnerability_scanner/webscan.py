from zapv2 import ZAPv2

ZAP_API_KEY = ''  # zap api
ZAP_ADDRESS = 'http://127.0.0.1'
ZAP_PORT = '8080'

zap = ZAPv2(apikey=ZAP_API_KEY, proxies={'http': f'{ZAP_ADDRESS}:{ZAP_PORT}', 'https': f'{ZAP_ADDRESS}:{ZAP_PORT}'})

def scan_web(target_url):
    print(f"Starting scan on {target_url}")
    zap.urlopen(target_url)
    zap.spider.scan(target_url)
    
    while int(zap.spider.status()) < 100:
        print("Spidering in progress...")
    
    zap.ascan.scan(target_url)
    while int(zap.ascan.status()) < 100:
        print("Active scanning in progress...")
    
    return zap.core.alerts()

if __name__ == "__main__":
    target = input("Enter target web URL: ")
    results = scan_web(target)
    print(results)

